{
  "services": [
    {
      "name": "leantime_db",
      "image": "mysql:8.4",
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/db_data",
          "containerPath": "/var/lib/mysql",
          "readOnly": false
        }
      ],
      "environment": {
        "MYSQL_ROOT_PASSWORD": "${MYSQL_ROOT_PASSWORD}",
        "MYSQL_DATABASE": "${LEAN_DB_DATABASE}",
        "MYSQL_USER": "${LEAN_DB_USER}",
        "MYSQL_PASSWORD": "${LEAN_DB_PASSWORD}"
      },
      "command": "--character-set-server=UTF8MB4 --collation-server=UTF8MB4_unicode_ci --default-authentication-plugin=mysql_native_password",
      "restart": "unless-stopped"
    },
    {
      "name": "leantime",
      "image": "leantime/leantime:latest",
      "isMain": true,
      "internalPort": 8080,
      "dependsOn": ["leantime_db"],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/public_userfiles",
          "containerPath": "/var/www/html/public/userfiles",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/data/userfiles",
          "containerPath": "/var/www/html/userfiles",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/data/plugins",
          "containerPath": "/var/www/html/app/Plugins",
          "readOnly": false
        },
        {
          "hostPath": "${APP_DATA_DIR}/data/logs",
          "containerPath": "/var/www/html/storage/logs",
          "readOnly": false
        }
      ],
      "environment": {
        "LEAN_DB_HOST": "leantime_db",
        "LEAN_DB_USER": "${LEAN_DB_USER}",
        "LEAN_DB_PASSWORD": "${LEAN_DB_PASSWORD}",
        "LEAN_DB_DATABASE": "${LEAN_DB_DATABASE}",
        "LEAN_EMAIL_RETURN": "${LEAN_EMAIL_RETURN}",
        "LEAN_APP_URL": "https://${APP_DOMAIN}",
        "LEAN_SESSION_PASSWORD": "${LEAN_SESSION_PASSWORD}"
      },
      "restart": "unless-stopped"
    }
  ]
}