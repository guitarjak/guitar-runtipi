{
  "services": [
    {
      "name": "web",
      "image": "eitchtee/wygiwyh:latest",
      "isMain": true,
      "internalPort": "8000",
      "command": "/start-single",
      "environment": {
        "TZ": "UTC",
        "DEBUG": "false",
        "HTTPS_ENABLED": "${HTTPS_ENABLED:-false}",
        "URL": "${URL:-}",
        "SECRET_KEY": "${SECRET_KEY:-wygiwyh-development-secret-key-change-in-production}",
        "DJANGO_ALLOWED_HOSTS": "${LOCAL_DOMAIN:-localhost} localhost 127.0.0.1 [::1]",
        "SQL_DATABASE": "wygiwyh",
        "SQL_USER": "wygiwyh",
        "SQL_PASSWORD": "wygiwyh-password",
        "SQL_HOST": "wygiwyh-db",
        "SQL_PORT": "5432",
        "SESSION_EXPIRY_TIME": "2678400",
        "ENABLE_SOFT_DELETE": "${ENABLE_SOFT_DELETE:-false}",
        "KEEP_DELETED_TRANSACTIONS_FOR": "365",
        "WEB_CONCURRENCY": "4",
        "TASK_WORKERS": "1",
        "ADMIN_EMAIL": "${ADMIN_EMAIL:-}",
        "ADMIN_PASSWORD": "${ADMIN_PASSWORD:-}",
        "CHECK_FOR_UPDATES": "${CHECK_FOR_UPDATES:-true}"
      },
      "dependsOn": ["wygiwyh-db"]
    },
    {
      "name": "wygiwyh-db",
      "image": "postgres:15",
      "environment": {
        "POSTGRES_DB": "wygiwyh",
        "POSTGRES_USER": "wygiwyh",
        "POSTGRES_PASSWORD": "wygiwyh-password",
        "POSTGRES_INITDB_ARGS": "--auth-host=scram-sha-256 --auth-local=scram-sha-256"
      },
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/postgres",
          "containerPath": "/var/lib/postgresql/data"
        }
      ],
      "healthCheck": {
        "test": "pg_isready -U wygiwyh -d wygiwyh",
        "interval": "10s",
        "timeout": "5s",
        "retries": 5,
        "startPeriod": "30s"
      }
    }
  ]
}